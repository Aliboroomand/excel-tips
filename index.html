<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ø³Ø§ÛŒØª ØªØ±ÙÙ†Ø¯Ù‡Ø§ÛŒ Ø§Ú©Ø³Ù„ - Ú©Ø§Ù…Ù„ Ùˆ Ù¾ÛŒØ´Ø±ÙØªÙ‡</title>
  <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazir-font@v30.1.0/dist/font-face.css" rel="stylesheet" type="text/css" />
  
  <!-- SEO Ø¨Ù‡Ø¨ÙˆØ¯ -->
  <meta name="description" content="Ø¢Ù…ÙˆØ²Ø´ ØªØ±ÙÙ†Ø¯Ù‡Ø§ÛŒ Ø§Ú©Ø³Ù„ - ÙØ±Ù…ÙˆÙ„â€ŒÙ‡Ø§ÛŒ Ù…Ø§Ù„ÛŒØŒ Ù…ØªÙ†ÛŒØŒ Ù…Ù†Ø·Ù‚ÛŒØŒ Ø¢Ø±Ø§ÛŒÙ‡â€ŒØ§ÛŒ Ùˆ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ø¨Ø§ Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ÛŒ Ùˆ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ Ú©Ù…Ú©ÛŒ">
  <meta name="keywords" content="Ø§Ú©Ø³Ù„, Ø¢Ù…ÙˆØ²Ø´ Ø§Ú©Ø³Ù„, ÙØ±Ù…ÙˆÙ„ Ø§Ú©Ø³Ù„, ØªØ±ÙÙ†Ø¯ Ø§Ú©Ø³Ù„, Ù…Ø§Ù„ÛŒ, Ù…ØªÙ†ÛŒ, Ù…Ù†Ø·Ù‚ÛŒ, Ø¢Ø±Ø§ÛŒÙ‡â€ŒØ§ÛŒ, VBA">
  <meta name="author" content="Ø¹Ù„ÛŒ Ø¨Ø±ÙˆÙ…Ù†Ø¯">
  
  <style>
    /* ØªÙ…Ø§Ù… Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ CSS Ú©Ù‡ Ù‚Ø¨Ù„Ø§Ù‹ Ø¯Ø§Ø´ØªÛŒØ¯ Ø§ÛŒÙ†Ø¬Ø§ Ù‚Ø±Ø§Ø± Ù…ÛŒâ€ŒÚ¯ÛŒØ±Ø¯ */
    /* Ø¨Ø±Ø§ÛŒ ØµØ±ÙÙ‡â€ŒØ¬ÙˆÛŒÛŒ Ø¯Ø± ÙØ¶Ø§ Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ Ø±Ø§ ØªÚ©Ø±Ø§Ø± Ù†Ù…ÛŒâ€ŒÚ©Ù†Ù… */
  </style>
</head>
<body>

<!-- Ù¾Ù†Ù„ Ù†Ø´Ø§Ù†â€ŒÙ‡Ø§ -->
<div class="overlay" id="overlay"></div>
<div class="bookmarks-panel" id="bookmarksPanel">
  <h3>ğŸ“‘ ÙØ±Ù…ÙˆÙ„â€ŒÙ‡Ø§ÛŒ Ù†Ø´Ø§Ù† Ø´Ø¯Ù‡</h3>
  <div id="bookmarksList"></div>
  <button class="btn" onclick="clearBookmarks()" style="margin-top: 20px; width: 100%;">Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù‡Ù…Ù‡ Ù†Ø´Ø§Ù†â€ŒÙ‡Ø§</button>
</div>

<header>
  <span>Ø³Ø§ÛŒØª ØªØ±ÙÙ†Ø¯Ù‡Ø§ÛŒ Ø§Ú©Ø³Ù„</span>
  <div class="header-controls">
    <button class="bookmarks-toggle" onclick="toggleBookmarks()">ğŸ“‘</button>
    <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ™</button>
  </div>
</header>

<nav>
  <a href="#home" class="nav-link">Ø®Ø§Ù†Ù‡</a>
  <button id="tipsBtn" aria-haspopup="true" aria-expanded="false">ØªØ±ÙÙ†Ø¯Ù‡Ø§ â–¼</button>
  <a href="#tools" class="nav-link">Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§</a>
  <a href="#quiz" class="nav-link">Ø¢Ø²Ù…ÙˆÙ†</a>
  <a href="#about" class="nav-link">Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù…Ø§</a>
  <a href="#contact" class="nav-link">ØªÙ…Ø§Ø³ Ø¨Ø§ Ù…Ø§</a>

  <div id="tipsDropdown" class="dropdown" role="menu" aria-label="Ø¯Ø³ØªÙ‡ Ø¨Ù†Ø¯ÛŒ ØªØ±ÙÙ†Ø¯Ù‡Ø§">
    <a href="#tips-financial" class="dropdown-link" role="menuitem">Ù…Ø§Ù„ÛŒ</a>
    <a href="#tips-text" class="dropdown-link" role="menuitem">Ù…ØªÙ†ÛŒ</a>
    <a href="#tips-logical" class="dropdown-link" role="menuitem">Ù…Ù†Ø·Ù‚ÛŒ</a>
    <a href="#tips-date" class="dropdown-link" role="menuitem">ØªØ§Ø±ÛŒØ® Ùˆ Ø²Ù…Ø§Ù†</a>
    <a href="#tips-lookup" class="dropdown-link" role="menuitem">Ø¬Ø³ØªØ¬Ùˆ Ùˆ Ù…Ø±Ø¬Ø¹</a>
    <a href="#tips-array" class="dropdown-link" role="menuitem">Ø¢Ø±Ø§ÛŒÙ‡â€ŒØ§ÛŒ</a>
    <a href="#tips-engineering" class="dropdown-link" role="menuitem">Ù…Ù‡Ù†Ø¯Ø³ÛŒ</a>
  </div>
</nav>

<main>
  <!-- Ø¨Ø§Ú©Ø³ Ø¬Ø³ØªØ¬Ùˆ -->
  <div class="search-box">
    <input type="text" id="searchInput" placeholder="Ø¬Ø³ØªØ¬ÙˆÛŒ ØªØ±ÙÙ†Ø¯Ù‡Ø§... (Ù…Ø«Ù„Ø§Ù‹: SUM, IF, VLOOKUP)" onfocus="showSearchHistory()">
    <div class="search-history" id="searchHistory"></div>
  </div>

  <!-- Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯Ø§Øª Ù‡ÙˆØ´Ù…Ù†Ø¯ -->
  <div class="suggestions" id="suggestions">
    <div class="suggestion-tag" onclick="searchThis('VLOOKUP')">VLOOKUP</div>
    <div class="suggestion-tag" onclick="searchThis('SUMIF')">SUMIF</div>
    <div class="suggestion-tag" onclick="searchThis('INDEX')">INDEX</div>
    <div class="suggestion-tag" onclick="searchThis('MATCH')">MATCH</div>
    <div class="suggestion-tag" onclick="searchThis('FILTER')">FILTER</div>
    <div class="suggestion-tag" onclick="searchThis('XLOOKUP')">XLOOKUP</div>
  </div>

  <section id="home" class="active" tabindex="0" aria-label="ØµÙØ­Ù‡ Ø®Ø§Ù†Ù‡">
    <!-- Ù…Ø­ØªÙˆØ§ÛŒ Ø®Ø§Ù†Ù‡ -->
  </section>

  <section id="tools" tabindex="0" aria-label="Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ ÙˆÛŒÚ˜Ù‡">
    <!-- Ù…Ø­ØªÙˆØ§ÛŒ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ -->
  </section>

  <section id="quiz" tabindex="0" aria-label="Ø¢Ø²Ù…ÙˆÙ† Ùˆ Ú©ÙˆØ¦ÛŒØ²">
    <!-- Ù…Ø­ØªÙˆØ§ÛŒ Ø¢Ø²Ù…ÙˆÙ† -->
  </section>

  <!-- Ø³Ø§ÛŒØ± Ø¨Ø®Ø´â€ŒÙ‡Ø§ÛŒ ØªØ±ÙÙ†Ø¯Ù‡Ø§ -->
  <section id="tips-financial" tabindex="0" aria-label="ØªØ±ÙÙ†Ø¯Ù‡Ø§ÛŒ Ù…Ø§Ù„ÛŒ">
    <!-- Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ø§Ù„ÛŒ -->
  </section>

  <section id="tips-text" tabindex="0" aria-label="ØªØ±ÙÙ†Ø¯Ù‡Ø§ÛŒ Ù…ØªÙ†ÛŒ">
    <h2>ğŸ“ ØªØ±ÙÙ†Ø¯Ù‡Ø§ÛŒ Ù…ØªÙ†ÛŒ</h2>
    
    <div class="formula-container">
      <button class="bookmark-btn" onclick="toggleBookmark(this)">ğŸ”–</button>
      <div class="formula" onclick="copyFormula(this)">
        =CONCATENATE(A1, " ", B1)
        <span class="copy-btn">Ú©Ù¾ÛŒ</span>
      </div>
      <button class="btn" onclick="toggleDesc(this)">Ù†Ù…Ø§ÛŒØ´ ØªÙˆØ¶ÛŒØ­Ø§Øª</button>
      <div class="desc">
        Ø¯Ùˆ ÛŒØ§ Ú†Ù†Ø¯ Ù…ØªÙ† Ø±Ø§ Ø¨Ù‡ Ù‡Ù… Ù…ØªØµÙ„ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.
      </div>
    </div>

    <div class="formula-container">
      <button class="bookmark-btn" onclick="toggleBookmark(this)">ğŸ”–</button>
      <div class="formula" onclick="copyFormula(this)">
        =LEFT(Ù…ØªÙ†, ØªØ¹Ø¯Ø§Ø¯_Ú©Ø§Ø±Ø§Ú©ØªØ±Ù‡Ø§)
        <span class="copy-btn">Ú©Ù¾ÛŒ</span>
      </div>
      <button class="btn" onclick="toggleDesc(this)">Ù†Ù…Ø§ÛŒØ´ ØªÙˆØ¶ÛŒØ­Ø§Øª</button>
      <div class="desc">
        ØªØ¹Ø¯Ø§Ø¯ Ù…Ø´Ø®ØµÛŒ Ú©Ø§Ø±Ø§Ú©ØªØ± Ø§Ø² Ø³Ù…Øª Ú†Ù¾ Ù…ØªÙ† Ø±Ø§ Ø¨Ø±Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ø§Ù†Ø¯.
      </div>
    </div>
  </section>

  <section id="tips-logical" tabindex="0" aria-label="ØªØ±ÙÙ†Ø¯Ù‡Ø§ÛŒ Ù…Ù†Ø·Ù‚ÛŒ">
    <h2>ğŸ” ØªØ±ÙÙ†Ø¯Ù‡Ø§ÛŒ Ù…Ù†Ø·Ù‚ÛŒ</h2>
    
    <div class="formula-container">
      <button class="bookmark-btn" onclick="toggleBookmark(this)">ğŸ”–</button>
      <div class="formula" onclick="copyFormula(this)">
        =IF(Ø´Ø±Ø·, Ù…Ù‚Ø¯Ø§Ø±_Ø§Ú¯Ø±_Ø¯Ø±Ø³Øª, Ù…Ù‚Ø¯Ø§Ø±_Ø§Ú¯Ø±_Ù†Ø§Ø¯Ø±Ø³Øª)
        <span class="copy-btn">Ú©Ù¾ÛŒ</span>
      </div>
      <button class="btn" onclick="toggleDesc(this)">Ù†Ù…Ø§ÛŒØ´ ØªÙˆØ¶ÛŒØ­Ø§Øª</button>
      <div class="desc">
        Ø¨Ø± Ø§Ø³Ø§Ø³ ÛŒÚ© Ø´Ø±Ø·ØŒ ÛŒÚ©ÛŒ Ø§Ø² Ø¯Ùˆ Ù…Ù‚Ø¯Ø§Ø± Ø±Ø§ Ø¨Ø±Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ø§Ù†Ø¯.
      </div>
    </div>
  </section>

  <!-- Ø³Ø§ÛŒØ± Ø¨Ø®Ø´â€ŒÙ‡Ø§... -->

  <section id="about" tabindex="0" aria-label="Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù…Ø§">
    <h2>Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù…Ø§</h2>
    <p>Ø§ÛŒÙ† ÙˆØ¨â€ŒØ³Ø§ÛŒØª Ø¨Ø§ Ù‡Ø¯Ù Ø¢Ù…ÙˆØ²Ø´ ØªØ±ÙÙ†Ø¯Ù‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø¯ÛŒ Ø§Ú©Ø³Ù„ Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯Ù‡ Ø§Ø³Øª.</p>
    <p>Ù…Ø§ Ø¨Ø± Ø§ÛŒÙ† Ø¨Ø§ÙˆØ±ÛŒÙ… Ú©Ù‡ ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ Ø§Ú©Ø³Ù„ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø¨Ù‡Ø±Ù‡â€ŒÙˆØ±ÛŒ Ø´Ù…Ø§ Ø±Ø§ Ø¨Ù‡ Ø·ÙˆØ± Ú†Ø´Ù…Ú¯ÛŒØ±ÛŒ Ø§ÙØ²Ø§ÛŒØ´ Ø¯Ù‡Ø¯.</p>
  </section>

  <section id="contact" tabindex="0" aria-label="ØªÙ…Ø§Ø³ Ø¨Ø§ Ù…Ø§">
    <h2>ØªÙ…Ø§Ø³ Ø¨Ø§ Ù…Ø§</h2>
    <form onsubmit="submitForm(event)">
      <label for="name">Ù†Ø§Ù…:</label>
      <input type="text" id="name" required>
      
      <label for="email">Ø§ÛŒÙ…ÛŒÙ„:</label>
      <input type="text" id="email" required>
      
      <label for="message">Ù¾ÛŒØ§Ù…:</label>
      <textarea id="message" required></textarea>
      
      <button type="submit">Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù…</button>
    </form>
    <div id="formResponse"></div>
  </section>
</main>

<footer>
  <p>Â© 2024 Ø³Ø§ÛŒØª ØªØ±ÙÙ†Ø¯Ù‡Ø§ÛŒ Ø§Ú©Ø³Ù„. ØªÙ…Ø§Ù… Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸ Ø§Ø³Øª.</p>
</footer>

<script>
// Ù…Ø¯ÛŒØ±ÛŒØª ÙˆØ¶Ø¹ÛŒØª
let currentTheme = localStorage.getItem('theme') || 'light';
let bookmarks = JSON.parse(localStorage.getItem('bookmarks')) || [];
let searchHistory = JSON.parse(localStorage.getItem('searchHistory')) || [];

// Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
document.addEventListener('DOMContentLoaded', function() {
  applyTheme();
  loadBookmarks();
  setupNavigation();
  setupSearch();
});

// Ù…Ø¯ÛŒØ±ÛŒØª Ù¾ÙˆØ³ØªÙ‡
function toggleTheme() {
  currentTheme = currentTheme === 'light' ? 'dark' : 'light';
  localStorage.setItem('theme', currentTheme);
  applyTheme();
}

function applyTheme() {
  if (currentTheme === 'dark') {
    document.body.classList.add('dark-mode');
  } else {
    document.body.classList.remove('dark-mode');
  }
}

// Ù…Ø¯ÛŒØ±ÛŒØª Ù†Ø§ÙˆØ¨Ø±ÛŒ
function setupNavigation() {
  // Ù„ÛŒÙ†Ú©â€ŒÙ‡Ø§ÛŒ Ù†Ø§ÙˆØ¨Ø±ÛŒ
  document.querySelectorAll('.nav-link').forEach(link => {
    link.addEventListener('click', function(e) {
      e.preventDefault();
      const targetId = this.getAttribute('href').substring(1);
      showSection(targetId);
    });
  });

  // Ù„ÛŒÙ†Ú©â€ŒÙ‡Ø§ÛŒ Ù…Ù†ÙˆÛŒ Ú©Ø´ÙˆÛŒÛŒ
  document.querySelectorAll('.dropdown-link').forEach(link => {
    link.addEventListener('click', function(e) {
      e.preventDefault();
      const targetId = this.getAttribute('href').substring(1);
      showSection(targetId);
      hideDropdown();
    });
  });

  // Ù…Ù†ÙˆÛŒ Ú©Ø´ÙˆÛŒÛŒ ØªØ±ÙÙ†Ø¯Ù‡Ø§
  const tipsBtn = document.getElementById('tipsBtn');
  const tipsDropdown = document.getElementById('tipsDropdown');

  tipsBtn.addEventListener('click', function(e) {
    e.stopPropagation();
    tipsDropdown.classList.toggle('show');
    tipsBtn.setAttribute('aria-expanded', tipsDropdown.classList.contains('show'));
  });

  // Ø¨Ø³ØªÙ† Ù…Ù†ÙˆÛŒ Ú©Ø´ÙˆÛŒÛŒ Ø¨Ø§ Ú©Ù„ÛŒÚ© Ø¨ÛŒØ±ÙˆÙ†
  document.addEventListener('click', function() {
    hideDropdown();
  });

  // Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø¨Ø³ØªÙ† Ù…Ù†Ùˆ Ù‡Ù†Ú¯Ø§Ù… Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ Ø®ÙˆØ¯ Ù…Ù†Ùˆ
  tipsDropdown.addEventListener('click', function(e) {
    e.stopPropagation();
  });
}

function hideDropdown() {
  const tipsDropdown = document.getElementById('tipsDropdown');
  tipsDropdown.classList.remove('show');
  document.getElementById('tipsBtn').setAttribute('aria-expanded', 'false');
}

function showSection(sectionId) {
  // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† ØªÙ…Ø§Ù… Ø¨Ø®Ø´â€ŒÙ‡Ø§
  document.querySelectorAll('section').forEach(section => {
    section.classList.remove('active');
  });

  // Ù†Ù…Ø§ÛŒØ´ Ø¨Ø®Ø´ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø±
  const targetSection = document.getElementById(sectionId);
  if (targetSection) {
    targetSection.classList.add('active');
    targetSection.focus();
  }

  // Ø¨Ø³ØªÙ† Ù…Ù†ÙˆÛŒ Ú©Ø´ÙˆÛŒÛŒ
  hideDropdown();
}

// Ù…Ø¯ÛŒØ±ÛŒØª Ù†Ø´Ø§Ù†â€ŒÙ‡Ø§
function toggleBookmarks() {
  const panel = document.getElementById('bookmarksPanel');
  const overlay = document.getElementById('overlay');
  
  panel.classList.toggle('show');
  overlay.classList.toggle('show');
  
  if (panel.classList.contains('show')) {
    displayBookmarks();
  }
}

function toggleBookmark(button) {
  const formulaContainer = button.closest('.formula-container');
  const formulaElement = formulaContainer.querySelector('.formula');
  const formulaText = formulaElement.textContent.trim();
  
  const index = bookmarks.findIndex(item => item.formula === formulaText);
  
  if (index === -1) {
    // Ø§ÙØ²ÙˆØ¯Ù† Ø¨Ù‡ Ù†Ø´Ø§Ù†â€ŒÙ‡Ø§
    const descElement = formulaContainer.querySelector('.desc');
    const description = descElement ? descElement.textContent.trim() : '';
    
    bookmarks.push({
      formula: formulaText,
      description: description,
      category: getFormulaCategory(formulaContainer)
    });
    
    button.classList.add('bookmarked');
    button.textContent = 'ğŸ”–';
  } else {
    // Ø­Ø°Ù Ø§Ø² Ù†Ø´Ø§Ù†â€ŒÙ‡Ø§
    bookmarks.splice(index, 1);
    button.classList.remove('bookmarked');
    button.textContent = 'ğŸ”–';
  }
  
  localStorage.setItem('bookmarks', JSON.stringify(bookmarks));
}

function getFormulaCategory(container) {
  const section = container.closest('section');
  return section ? section.querySelector('h2').textContent : 'Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ Ù†Ø´Ø¯Ù‡';
}

function displayBookmarks() {
  const bookmarksList = document.getElementById('bookmarksList');
  
  if (bookmarks.length === 0) {
    bookmarksList.innerHTML = '<p>Ù‡ÛŒÚ† ÙØ±Ù…ÙˆÙ„ÛŒ Ù†Ø´Ø§Ù†Ù‡â€ŒÚ¯Ø°Ø§Ø±ÛŒ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</p>';
    return;
  }
  
  bookmarksList.innerHTML = '';
  bookmarks.forEach((bookmark, index) => {
    const item = document.createElement('div');
    item.className = 'bookmark-item';
    item.innerHTML = `
      <strong>${bookmark.formula}</strong>
      <p>${bookmark.description}</p>
      <small>${bookmark.category}</small>
    `;
    item.addEventListener('click', function() {
      // Ø±ÙØªÙ† Ø¨Ù‡ Ø¨Ø®Ø´ Ù…Ø±Ø¨ÙˆØ·Ù‡
      const categoryMap = {
        'ğŸ’° ØªØ±ÙÙ†Ø¯Ù‡Ø§ÛŒ Ù…Ø§Ù„ÛŒ': 'tips-financial',
        'ğŸ“ ØªØ±ÙÙ†Ø¯Ù‡Ø§ÛŒ Ù…ØªÙ†ÛŒ': 'tips-text',
        'ğŸ” ØªØ±ÙÙ†Ø¯Ù‡Ø§ÛŒ Ù…Ù†Ø·Ù‚ÛŒ': 'tips-logical'
        // Ø§ÙØ²ÙˆØ¯Ù† Ø³Ø§ÛŒØ± Ø¯Ø³ØªÙ‡â€ŒÙ‡Ø§
      };
      
      const targetSection = categoryMap[bookmark.category] || 'home';
      showSection(targetSection);
      toggleBookmarks(); // Ø¨Ø³ØªÙ† Ù¾Ù†Ù„ Ù†Ø´Ø§Ù†â€ŒÙ‡Ø§
    });
    
    bookmarksList.appendChild(item);
  });
}

function clearBookmarks() {
  if (confirm('Ø¢ÛŒØ§ Ø§Ø² Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù‡Ù…Ù‡ Ù†Ø´Ø§Ù†â€ŒÙ‡Ø§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ')) {
    bookmarks = [];
    localStorage.setItem('bookmarks', JSON.stringify(bookmarks));
    displayBookmarks();
    
    // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ø´Ø§Ù†â€ŒÙ‡Ø§ Ø¯Ø± ØµÙØ­Ù‡
    document.querySelectorAll('.bookmark-btn').forEach(btn => {
      btn.classList.remove('bookmarked');
      btn.textContent = 'ğŸ”–';
    });
  }
}

function loadBookmarks() {
  // Ø¹Ù„Ø§Ù…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ ÙØ±Ù…ÙˆÙ„â€ŒÙ‡Ø§ÛŒ Ù†Ø´Ø§Ù†â€ŒØ´Ø¯Ù‡ Ø¯Ø± ØµÙØ­Ù‡
  document.querySelectorAll('.formula-container').forEach(container => {
    const formulaElement = container.querySelector('.formula');
    const formulaText = formulaElement.textContent.trim();
    const bookmarkBtn = container.querySelector('.bookmark-btn');
    
    const isBookmarked = bookmarks.some(item => item.formula === formulaText);
    if (isBookmarked) {
      bookmarkBtn.classList.add('bookmarked');
      bookmarkBtn.textContent = 'ğŸ”–';
    }
  });
}

// Ù…Ø¯ÛŒØ±ÛŒØª Ø¬Ø³ØªØ¬Ùˆ
function setupSearch() {
  const searchInput = document.getElementById('searchInput');
  
  searchInput.addEventListener('input', function() {
    performSearch(this.value);
  });
  
  searchInput.addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
      addToSearchHistory(this.value);
      performSearch(this.value);
    }
  });
}

function performSearch(query) {
  if (!query.trim()) {
    // Ù†Ù…Ø§ÛŒØ´ ØªÙ…Ø§Ù… Ù…ÙˆØ§Ø±Ø¯ Ø§Ú¯Ø± Ø¬Ø³ØªØ¬Ùˆ Ø®Ø§Ù„ÛŒ Ø§Ø³Øª
    document.querySelectorAll('.formula-container').forEach(container => {
      container.classList.remove('hidden');
    });
    return;
  }
  
  const searchTerm = query.toLowerCase();
  let foundResults = false;
  
  document.querySelectorAll('.formula-container').forEach(container => {
    const formulaText = container.querySelector('.formula').textContent.toLowerCase();
    const descText = container.querySelector('.desc').textContent.toLowerCase();
    
    if (formulaText.includes(searchTerm) || descText.includes(searchTerm)) {
      container.classList.remove('hidden');
      foundResults = true;
    } else {
      container.classList.add('hidden');
    }
  });
  
  // Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù… Ø§Ú¯Ø± Ù†ØªÛŒØ¬Ù‡â€ŒØ§ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯
  const noResultsMsg = document.getElementById('noResultsMessage');
  if (!foundResults) {
    if (!noResultsMsg) {
      const msg = document.createElement('div');
      msg.id = 'noResultsMessage';
      msg.style.textAlign = 'center';
      msg.style.padding = '20px';
      msg.style.color = '#666';
      msg.innerHTML = `Ù†ØªÛŒØ¬Ù‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ "${query}" ÛŒØ§ÙØª Ù†Ø´Ø¯.`;
      document.querySelector('main').appendChild(msg);
    }
  } else if (noResultsMsg) {
    noResultsMsg.remove();
  }
}

function showSearchHistory() {
  const historyContainer = document.getElementById('searchHistory');
  
  if (searchHistory.length === 0) {
    historyContainer.innerHTML = '<div>ØªØ§Ø±ÛŒØ®Ú†Ù‡â€ŒØ§ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯</div>';
  } else {
    historyContainer.innerHTML = '';
    searchHistory.slice().reverse().forEach(term => {
      const item = document.createElement('div');
      item.textContent = term;
      item.addEventListener('click', function() {
        document.getElementById('searchInput').value = term;
        performSearch(term);
        hideSearchHistory();
      });
      historyContainer.appendChild(item);
    });
  }
  
  historyContainer.classList.add('show');
}

function hideSearchHistory() {
  document.getElementById('searchHistory').classList.remove('show');
}

function addToSearchHistory(term) {
  if (!term.trim()) return;
  
  // Ø­Ø°Ù Ø§Ú¯Ø± Ù‚Ø¨Ù„Ø§Ù‹ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯
  searchHistory = searchHistory.filter(item => item !== term);
  
  // Ø§ÙØ²ÙˆØ¯Ù† Ø¨Ù‡ Ø§Ø¨ØªØ¯Ø§
  searchHistory.unshift(term);
  
  // Ù…Ø­Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† Ø¨Ù‡ 10 Ù…ÙˆØ±Ø¯
  if (searchHistory.length > 10) {
    searchHistory = searchHistory.slice(0, 10);
  }
  
  localStorage.setItem('searchHistory', JSON.stringify(searchHistory));
}

function searchThis(term) {
  document.getElementById('searchInput').value = term;
  addToSearchHistory(term);
  performSearch(term);
}

// Ø¨Ø³ØªÙ† ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ø¬Ø³ØªØ¬Ùˆ Ø¨Ø§ Ú©Ù„ÛŒÚ© Ø¨ÛŒØ±ÙˆÙ†
document.addEventListener('click', function(e) {
  if (!e.target.closest('.search-box')) {
    hideSearchHistory();
  }
});

// Ø¹Ù…Ù„Ú©Ø±Ø¯Ù‡Ø§ÛŒ Ú©Ù…Ú©ÛŒ
function toggleDesc(button) {
  const desc = button.parentElement.querySelector('.desc');
  desc.style.display = desc.style.display === 'block' ? 'none' : 'block';
  button.textContent = desc.style.display === 'block' ? 'Ù¾Ù†Ù‡Ø§Ù† Ú©Ø±Ø¯Ù† ØªÙˆØ¶ÛŒØ­Ø§Øª' : 'Ù†Ù…Ø§ÛŒØ´ ØªÙˆØ¶ÛŒØ­Ø§Øª';
}

function copyFormula(element) {
  const text = element.textContent.replace('Ú©Ù¾ÛŒ', '').trim();
  
  // Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Clipboard API Ø¬Ø¯ÛŒØ¯
  navigator.clipboard.writeText(text).then(() => {
    // Ù†Ù…Ø§ÛŒØ´ ØªØ£ÛŒÛŒØ¯ Ù…ÙˆÙ‚Øª
    const originalText = element.textContent;
    element.textContent = 'Ú©Ù¾ÛŒ Ø´Ø¯!';
    element.style.background = '#d4edda';
    
    setTimeout(() => {
      element.innerHTML = originalText;
      element.style.background = '';
    }, 1500);
  }).catch(() => {
    // Ø±ÙˆØ´ Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ø¨Ø±Ø§ÛŒ Ù…Ø±ÙˆØ±Ú¯Ø±Ù‡Ø§ÛŒ Ù‚Ø¯ÛŒÙ…ÛŒ
    const textArea = document.createElement('textarea');
    textArea.value = text;
    document.body.appendChild(textArea);
    textArea.select();
    document.execCommand('copy');
    document.body.removeChild(textArea);
    
    // Ù†Ù…Ø§ÛŒØ´ ØªØ£ÛŒÛŒØ¯
    const originalText = element.textContent;
    element.textContent = 'Ú©Ù¾ÛŒ Ø´Ø¯!';
    element.style.background = '#d4edda';
    
    setTimeout(() => {
      element.innerHTML = originalText;
      element.style.background = '';
    }, 1500);
  });
}

function rateFormula(button) {
  const container = button.closest('.formula-container');
  const stars = container.querySelector('.stars');
  
  // Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù…
  alert('Ø§Ù…ØªÛŒØ§Ø² Ø´Ù…Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø«Ø¨Øª Ø´Ø¯!');
  
  // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¸Ø§Ù‡Ø±ÛŒ (Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§ÛŒÙ† Ø±Ø§ Ø¨Ø§ Ù…Ù†Ø·Ù‚ Ø³Ø±ÙˆØ± Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ú©Ù†ÛŒØ¯)
  const ratingText = container.querySelector('.rating span:last-child');
  const currentVotes = parseInt(ratingText.textContent.match(/\d+/)[0]);
  ratingText.textContent = `(${currentVotes + 1} Ø±Ø§ÛŒ)`;
}

function rateItem(starsElement) {
  // Ù…Ù†Ø·Ù‚ Ø³Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ø§Ù…ØªÛŒØ§Ø²Ø¯Ù‡ÛŒ
  alert('Ø§Ø² Ø§Ù…ØªÛŒØ§Ø²Ø¯Ù‡ÛŒ Ø´Ù…Ø§ Ù…ØªØ´Ú©Ø±ÛŒÙ…!');
}

// Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§
function calculateFormula() {
  const input = document.getElementById('formulaInput').value;
  const resultDiv = document.getElementById('calcResult');
  
  if (!input.trim()) {
    resultDiv.textContent = 'Ù„Ø·ÙØ§Ù‹ ÛŒÚ© ÙØ±Ù…ÙˆÙ„ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯';
    return;
  }
  
  try {
    // Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ†ÛŒ ØªÙˆØ§Ø¨Ø¹ Ø§Ú©Ø³Ù„ Ø¨Ø§ Ù…Ø¹Ø§Ø¯Ù„â€ŒÙ‡Ø§ÛŒ JavaScript
    let expression = input
      .replace(/SUM\(([^)]+)\)/gi, (match, args) => {
        const numbers = args.split(',').map(num => parseFloat(num.trim()));
        return numbers.reduce((sum, num) => sum + num, 0);
      })
      .replace(/AVERAGE\(([^)]+)\)/gi, (match, args) => {
        const numbers = args.split(',').map(num => parseFloat(num.trim()));
        return numbers.reduce((sum, num) => sum + num, 0) / numbers.length;
      });
    
    // Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒ Ø¹Ø¨Ø§Ø±Øª (Ø¨Ø§ Ø§Ø­ØªÛŒØ§Ø·)
    const result = eval(expression);
    resultDiv.textContent = `Ù†ØªÛŒØ¬Ù‡: ${result}`;
    resultDiv.style.background = '#d4edda';
  } catch (error) {
    resultDiv.textContent = `Ø®Ø·Ø§: ÙØ±Ù…ÙˆÙ„ Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª - ${error.message}`;
    resultDiv.style.background = '#f8d7da';
  }
}

function updateBuilderOptions() {
  const functionType = document.getElementById('functionType').value;
  const optionsDiv = document.getElementById('builderOptions');
  
  let optionsHTML = '';
  
  switch (functionType) {
    case 'math':
      optionsHTML = `
        <select id="mathFunction">
          <option value="SUM">SUM - Ø¬Ù…Ø¹</option>
          <option value="AVERAGE">AVERAGE - Ù…ÛŒØ§Ù†Ú¯ÛŒÙ†</option>
          <option value="MAX">MAX - Ø¨ÛŒØ´ØªØ±ÛŒÙ† Ù…Ù‚Ø¯Ø§Ø±</option>
          <option value="MIN">MIN - Ú©Ù…ØªØ±ÛŒÙ† Ù…Ù‚Ø¯Ø§Ø±</option>
        </select>
        <input type="text" id="mathRange" placeholder="Ù…Ø­Ø¯ÙˆØ¯Ù‡ (Ù…Ø«Ù„Ø§Ù‹ A1:A10)" dir="ltr">
      `;
      break;
    case 'text':
      optionsHTML = `
        <select id="textFunction">
          <option value="CONCATENATE">CONCATENATE - Ø§ØªØµØ§Ù„ Ù…ØªÙ†</option>
          <option value="LEFT">LEFT - Ú©Ø§Ø±Ø§Ú©ØªØ±Ù‡Ø§ÛŒ Ú†Ù¾</option>
          <option value="RIGHT">RIGHT - Ú©Ø§Ø±Ø§Ú©ØªØ±Ù‡Ø§ÛŒ Ø±Ø§Ø³Øª</option>
          <option value="LEN">LEN - Ø·ÙˆÙ„ Ù…ØªÙ†</option>
        </select>
        <input type="text" id="textInput1" placeholder="Ù…ØªÙ† ÛŒØ§ Ø³Ù„ÙˆÙ„ Ø§ÙˆÙ„">
        <input type="text" id="textInput2" placeholder="Ù…ØªÙ† ÛŒØ§ Ø³Ù„ÙˆÙ„ Ø¯ÙˆÙ… (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)">
      `;
      break;
    case 'logical':
      optionsHTML = `
        <select id="logicalFunction">
          <option value="IF">IF - Ø´Ø±Ø·ÛŒ</option>
          <option value="AND">AND - Ùˆ Ù…Ù†Ø·Ù‚ÛŒ</option>
          <option value="OR">OR - ÛŒØ§ Ù…Ù†Ø·Ù‚ÛŒ</option>
        </select>
        <input type="text" id="logicalCondition" placeholder="Ø´Ø±Ø· (Ù…Ø«Ù„Ø§Ù‹ A1>10)">
        <input type="text" id="trueValue" placeholder="Ù…Ù‚Ø¯Ø§Ø± Ø§Ú¯Ø± Ø¯Ø±Ø³Øª">
        <input type="text" id="falseValue" placeholder="Ù…Ù‚Ø¯Ø§Ø± Ø§Ú¯Ø± Ù†Ø§Ø¯Ø±Ø³Øª">
      `;
      break;
    default:
      optionsHTML = '<p>Ù„Ø·ÙØ§Ù‹ Ù†ÙˆØ¹ ØªØ§Ø¨Ø¹ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</p>';
  }
  
  optionsDiv.innerHTML = optionsHTML;
}

function generateFormula() {
  const functionType = document.getElementById('functionType').value;
  const resultDiv = document.getElementById('builderResult');
  
  if (!functionType) {
    resultDiv.innerHTML = '<p style="color: red;">Ù„Ø·ÙØ§Ù‹ Ù†ÙˆØ¹ ØªØ§Ø¨Ø¹ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</p>';
    return;
  }
  
  let formula = '';
  
  switch (functionType) {
    case 'math':
      const mathFunc = document.getElementById('mathFunction').value;
      const mathRange = document.getElementById('mathRange').value;
      formula = `=${mathFunc}(${mathRange})`;
      break;
      
    case 'text':
      const textFunc = document.getElementById('textFunction').value;
      const text1 = document.getElementById('textInput1').value;
      const text2 = document.getElementById('textInput2').value;
      
      if (textFunc === 'CONCATENATE') {
        formula = `=${textFunc}(${text1}${text2 ? `, "${text2}"` : ''})`;
      } else {
        formula = `=${textFunc}(${text1})`;
      }
      break;
      
    case 'logical':
      const logicalFunc = document.getElementById('logicalFunction').value;
      const condition = document.getElementById('logicalCondition').value;
      const trueVal = document.getElementById('trueValue').value;
      const falseVal = document.getElementById('falseValue').value;
      
      if (logicalFunc === 'IF') {
        formula = `=IF(${condition}, ${trueVal}, ${falseVal})`;
      } else {
        formula = `=${logicalFunc}(${condition})`;
      }
      break;
  }
  
  resultDiv.innerHTML = `
    <div style="background: #eef6fb; padding: 15px; border-radius: 5px; margin: 10px 0;">
      <strong>ÙØ±Ù…ÙˆÙ„ Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯Ù‡:</strong>
      <div class="formula" onclick="copyFormula(this)" style="margin-top: 10px; cursor: pointer;">
        ${formula}
        <span class="copy-btn">Ú©Ù¾ÛŒ</span>
      </div>
    </div>
  `;
}

// Ø¢Ø²Ù…ÙˆÙ†
function checkAnswer(questionId, correctAnswer, button) {
  const allButtons = button.parentElement.querySelectorAll('.quiz-btn');
  const userAnswer = button.textContent;
  
  // ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† ØªÙ…Ø§Ù… Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø§ÛŒÙ† Ø³ÙˆØ§Ù„
  allButtons.forEach(btn => {
    btn.disabled = true;
    if (btn.textContent === correctAnswer) {
      btn.classList.add('correct');
    } else if (btn === button && userAnswer !== correctAnswer) {
      btn.classList.add('incorrect');
    }
  });
  
  // Ø¨Ø±Ø±Ø³ÛŒ Ù†ØªÛŒØ¬Ù‡ Ú©Ù„ÛŒ
  checkQuizCompletion();
}

function checkQuizCompletion() {
  const allQuestions = document.querySelectorAll('.question');
  const answeredQuestions = document.querySelectorAll('.question .quiz-btn:disabled');
  
  if (allQuestions.length === answeredQuestions.length) {
    const correctAnswers = document.querySelectorAll('.quiz-btn.correct').length;
    const totalQuestions = allQuestions.length;
    const percentage = (correctAnswers / totalQuestions) * 100;
    
    const resultDiv = document.getElementById('quizResult');
    resultDiv.textContent = `Ù†ØªÛŒØ¬Ù‡ Ø¢Ø²Ù…ÙˆÙ†: ${correctAnswers} Ø§Ø² ${totalQuestions} (${percentage}%)`;
    resultDiv.style.color = percentage >= 70 ? 'green' : 'red';
    
    document.getElementById('resetQuizBtn').style.display = 'block';
  }
}

function resetQuiz() {
  document.querySelectorAll('.quiz-btn').forEach(btn => {
    btn.disabled = false;
    btn.classList.remove('correct', 'incorrect');
  });
  
  document.getElementById('quizResult').textContent = '';
  document.getElementById('resetQuizBtn').style.display = 'none';
}

// ÙØ±Ù… ØªÙ…Ø§Ø³
function submitForm(event) {
  event.preventDefault();
  
  const name = document.getElementById('name').value;
  const email = document.getElementById('email').value;
  const message = document.getElementById('message').value;
  
  // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø§Ø±Ø³Ø§Ù„ ÙØ±Ù…
  const responseDiv = document.getElementById('formResponse');
  responseDiv.textContent = `Ù¾ÛŒØ§Ù… Ø´Ù…Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯! Ø¨Ø§ ØªØ´Ú©Ø± Ø§Ø² Ø´Ù…Ø§ØŒ ${name}.`;
  responseDiv.style.color = 'green';
  
  // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ÙØ±Ù…
  document.getElementById('name').value = '';
  document.getElementById('email').value = '';
  document.getElementById('message').value = '';
  
  // Ù¾Ù†Ù‡Ø§Ù† Ú©Ø±Ø¯Ù† Ù¾ÛŒØ§Ù… Ù¾Ø³ Ø§Ø² 5 Ø«Ø§Ù†ÛŒÙ‡
  setTimeout(() => {
    responseDiv.textContent = '';
  }, 5000);
}

// Ø³Ø§ÛŒØ± Ø¹Ù…Ù„Ú©Ø±Ø¯Ù‡Ø§
function downloadSample() {
  alert('Ø¯Ø± Ø§ÛŒÙ† Ù†Ø³Ø®Ù‡ Ù†Ù…Ø§ÛŒØ´ÛŒØŒ Ù„ÛŒÙ†Ú© Ø¯Ø§Ù†Ù„ÙˆØ¯ ÙØ¹Ø§Ù„ Ù†ÛŒØ³Øª. Ø¯Ø± Ù†Ø³Ø®Ù‡ Ú©Ø§Ù…Ù„ØŒ Ø§ÛŒÙ† Ù„ÛŒÙ†Ú© ÛŒÚ© ÙØ§ÛŒÙ„ Ø§Ú©Ø³Ù„ Ù†Ù…ÙˆÙ†Ù‡ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.');
}

function showChallengeSolution() {
  const solution = document.getElementById('challengeSolution');
  solution.style.display = solution.style.display === 'block' ? 'none' : 'block';
}

// Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ Ø¨Ø®Ø´â€ŒÙ‡Ø§ÛŒ Ø§Ø¶Ø§ÙÛŒ
document.addEventListener('DOMContentLoaded', function() {
  // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù…Ø­ØªÙˆØ§ÛŒ Ø¨ÛŒØ´ØªØ± Ø¨Ù‡ Ø¨Ø®Ø´â€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù
  initializeAdditionalContent();
});

function initializeAdditionalContent() {
  // Ø§ÛŒÙ† ØªØ§Ø¨Ø¹ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø¨Ø±Ø§ÛŒ Ø§ÙØ²ÙˆØ¯Ù† Ù…Ø­ØªÙˆØ§ÛŒ Ù¾ÙˆÛŒØ§ Ø¨Ù‡ Ø¨Ø®Ø´â€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´ÙˆØ¯
}
</script>
</body>
</html>
